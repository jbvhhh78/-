-- 尝试这些格式：
loadstring(game:HttpGet("https://raw.githubusercontent.com/jbvhhh78/-/af9f11f4693b4001a44968065c7ba0bb2e45bf3b/%E5%AD%90%E8%84%9A%E6%9C%AC.lua"))()

-- 或者添加错误处理：
local success, err = pcall(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/jbvhhh78/-/af9f11f4693b4001a44968065c7ba0bb2e45bf3b/%E5%AD%90%E8%84%9A%E6%9C%AC.lua"))()

if not success then
    warn("脚本加载失败: " .. err)
end

local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/dist/main.lua"))()

WindUI.TransparencyValue = 0.3
WindUI:SetTheme("Dark")

-- 初始欢迎弹窗
WindUI:Popup({
    Title = "欢迎使用子脚本",
    Icon = "sparkles",
    Content = "尊贵的子脚本用户 "..game.Players.LocalPlayer.Name..", 测试",
    Buttons = {
        {
            Title = "启动",
            Icon = "arrow-right",
            Variant = "Primary",
            Callback = function() 
                print("脚本已启动")
            end
        }
    }
})

wait(10)

-- 创建主窗口
local Window = WindUI:CreateWindow({
    Title = "子脚本", 
    Icon = "star", 
    Author = "尊贵的 "..game.Players.LocalPlayer.Name.."，欢迎使用子脚本", 
    Folder = "WindUI_Example", 
    Size = UDim2.fromOffset(400, 250), 
    Background = "rbxassetid://16750449550", 
    Theme = "Dark",
    
    User = {
        Enabled = true, 
        Anonymous = false, 
        Callback = function() 
            WindUI:Notify({
                Title = "点吧",
                Content = "不是你真点啊",
                Duration = 3
            })
        end
    },
    SideBarWidth = 200,
    ScrollBarEnabled = false 
})

-- 添加标签
Window:Tag({
    Title = "v1.0",
    Color = Color3.fromHex("#30ff6a")
})

Window:Tag({
    Title = "正式版", 
    Color = Color3.fromHex("#315dff")
})

local TimeTag = Window:Tag({
    Title = "马上更新",
    Color = Color3.fromHex("#000000")
})

-- 创建标签页
local Tabs = {
    Game = Window:Section({ Title = "面板", Icon = "user", Opened = true })
}

local TabHandles = {
    GameSettings = Tabs.Game:Tab({ Title = "主要", Icon = "user" }),
    Scripts = Tabs.Game:Tab({ Title = "脚本", Icon = "code" }),
    JibaSettings = Tabs.Game:Tab({ Title = "关于作者", Icon = "info"}),
    UiSettings = Tabs.Game:Tab({ Title = "UI设置", Icon = "settings" }),
    YinyueSettings = Tabs.Game:Tab({ Title = "播放音乐", Icon = "music" }),
}

-- 主要设置标签
TabHandles.GameSettings:Paragraph({
    Title = "帮助作者完成一件事情领取一元奖励",
    Desc = "作者：子杨",
    Image = "Settings",
    ImageSize = 20,
    Color = "White"
})

-- 脚本功能
local function loadExternalScript(url, key, value, scriptName)
    WindUI:Notify({
        Title = "提示",
        Content = "正在加载 " .. scriptName .. "...",
        Duration = 3
    })
    
    task.spawn(function()
        local success, err = pcall(function()
            -- 设置环境变量
            if key and value then
                getgenv()[key] = value
            end
            
            -- 加载脚本
            local scriptContent = game:HttpGet(url)
            loadstring(scriptContent)()
        end)
        
        if success then
            WindUI:Notify({
                Title = "成功",
                Content = scriptName .. " 加载完成",
                Duration = 3
            })
        else
            WindUI:Notify({
                Title = "失败",
                Content = scriptName .. " 错误: " .. tostring(err),
                Duration = 5
            })
        end
    end)
end

-- 被遗弃脚本
TabHandles.Scripts:Button({
    Title = "被遗弃脚本",
    Desc = "点击启动被遗弃脚本",
    Value = false,
    Callback = function()
        loadExternalScript(
            "https://raw.githubusercontent.com/Syndromehsh/NOL/refs/heads/main/Nolsaken",
            "ADittoKey",
            "NOL_FRERKEY_THISISFOR",
            "被遗弃脚本"
        )
    end
})

-- 皮脚本
TabHandles.Scripts:Button({
    Title = "皮脚本",
    Desc = "点击启动皮脚本",
    Value = false,
    Callback = function()
        loadExternalScript(
            "https://raw.githubusercontent.com/xiaopi77/xiaopi77/main/QQ1002100032-Roblox-Pi-script.lua",
            "XiaoPi",
            "皮脚本QQ群1002100032",
            "皮脚本"
        )
    end
})

-- 添加皮脚本内脏与火药按钮到脚本标签页
TabHandles.Scripts:Button({
    Title = "皮脚本内脏与火药",
    Desc = "点击启动皮脚本内脏与火药",
    Value = false,
    Callback = function()
        WindUI:Notify({
            Title = "提示",
            Content = "正在加载皮脚本内脏与火药...",
            Duration = 3
        })
        
        task.spawn(function()
            local success, err = pcall(function()
                getgenv().XiaoPi = "皮脚本-内脏与黑火药"
                loadstring(game:HttpGet("https://raw.githubusercontent.com/xiaopi77/xiaopi77/refs/heads/main/Roblox-Pi-GB-Script.lua"))()
            end)
            
            if success then
                WindUI:Notify({
                    Title = "成功",
                    Content = "脚本加载完成",
                    Duration = 3
                })
            else
                WindUI:Notify({
                    Title = "失败",
                    Content = "错误: " .. tostring(err),
                    Duration = 5
                })
            end
        end)
    end
})

-- 添加更多脚本按钮示例
TabHandles.Scripts:Button({
    Title = "复制脚本链接",
    Desc = "复制脚本GitHub链接",
    Value = false,
    Callback = function()
        setclipboard("https://github.com/Syndromehsh/NOL")
        WindUI:Notify({
            Title = "复制成功",
            Content = "脚本链接已复制到剪贴板",
            Duration = 3
        })
    end
})

-- 作者信息
TabHandles.GameSettings:Button({
    Title = "访问作者QQ",
    Desc = "点击复制QQ号",
    Value = false,
    Callback = function()
        setclipboard("3775449458")
        WindUI:Notify({
            Title = "复制成功",
            Content = "QQ号 3775449458 已复制到剪贴板",
            Duration = 3
        })
    end
})

TabHandles.GameSettings:Button({
    Title = "脚本更新链接",
    Desc = "获取最新版本脚本",
    Value = false,
    Callback = function()
        setclipboard("https://github.com/你的用户名/你的仓库")
        WindUI:Notify({
            Title = "链接已复制",
            Content = "脚本链接已复制到剪贴板",
            Duration = 3
        })
    end
})

-- 关于作者标签
TabHandles.JibaSettings:Paragraph({
    Title = "关于作者",
    Desc = "子脚本开发者\nQQ: 3775449458\n感谢使用！",
    Image = "Info",
    ImageSize = 20,
    Color = "White"
})

TabHandles.JibaSettings:Button({
    Title = "加入交流群",
    Desc = "获取群号",
    Value = false,
    Callback = function()
        setclipboard("1002100032")
        WindUI:Notify({
            Title = "群号已复制",
            Content = "QQ群号 1002100032 已复制",
            Duration = 3
        })
    end
})

-- UI设置标签
TabHandles.UiSettings:Paragraph({
    Title = "设置UI",
    Desc = "自定义界面外观",
    Image = "Settings",
    ImageSize = 20,
    Color = "White"
})

-- 主题选择
local themeValues = {}
for name, _ in pairs(WindUI:GetThemes()) do
    table.insert(themeValues, name)
end

local themeDropdown = TabHandles.UiSettings:Dropdown({
    Title = "更改UI颜色",
    Multi = false,
    AllowNone = false,
    Value = nil,
    Values = themeValues,
    Callback = function(theme)
        WindUI:SetTheme(theme)
        WindUI:Notify({
            Title = "主题已切换",
            Content = "当前主题: " .. theme,
            Duration = 2
        })
    end
})

themeDropdown:Select(WindUI:GetCurrentTheme())

-- 透明度滑块
TabHandles.UiSettings:Slider({
    Title = "界面透明度",
    Min = 0,
    Max = 1,
    Value = 0.3,
    Callback = function(value)
        WindUI.TransparencyValue = value
        WindUI:Notify({
            Title = "透明度已更新",
            Content = "当前透明度: " .. string.format("%.1f", value),
            Duration = 1
        })
    end
})

-- 音乐播放标签
TabHandles.YinyueSettings:Paragraph({
    Title = "音乐播放器",
    Desc = "这才是真正的音乐。",
    Image = "Music",
    ImageSize = 20,
    Color = "White"
})

-- 音乐列表
local musicList = {
    {
        Title = "哈基米山歌",
        Desc = "哈基米呦南北绿豆",
        SoundId = "rbxassetid://71090232224338"
    },
    {
        Title = "停止所有音乐",
        Desc = "停止当前播放的音乐",
        SoundId = nil
    }
}

for _, music in ipairs(musicList) do
    TabHandles.YinyueSettings:Button({
        Title = music.Title,
        Desc = music.Desc,
        Value = false,
        Callback = function()
            if music.SoundId then
                local sound = Instance.new("Sound")
                sound.SoundId = music.SoundId
                sound.Volume = 0.5  -- 修正音量值（应该在0-1之间）
                sound.Looped = false
                sound.Parent = workspace
                sound:Play()
                
                WindUI:Notify({
                    Title = "音乐播放",
                    Content = "正在播放: " .. music.Title,
                    Duration = 2
                })
                
                -- 播放结束后自动清理
                sound.Ended:Connect(function()
                    sound:Destroy()
                end)
            else
                -- 停止所有音乐
                for _, sound in pairs(workspace:GetChildren()) do
                    if sound:IsA("Sound") then
                        sound:Stop()
                        sound:Destroy()
                    end
                end
                WindUI:Notify({
                    Title = "音乐已停止",
                    Content = "所有音乐播放已停止",
                    Duration = 2
                })
            end
        end
    })
end

-- 游戏功能
TabHandles.GameSettings:Button({
    Title = "一键传送",
    Desc = "传送到安全区域",
    Value = false,
    Callback = function()
        local character = game.Players.LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            character.HumanoidRootPart.CFrame = CFrame.new(0, 100, 0)  -- 示例坐标
            WindUI:Notify({
                Title = "传送成功",
                Content = "已传送到安全区域",
                Duration = 3
            })
        else
            WindUI:Notify({
                Title = "传送失败",
                Content = "角色不存在或无法传送",
                Duration = 3
            })
        end
    end
})

TabHandles.GameSettings:Toggle({
    Title = "自动收集",
    Desc = "自动收集附近资源",
    Value = false,
    Callback = function(value)
        if value then
            WindUI:Notify({
                Title = "自动收集已开启",
                Content = "开始自动收集资源",
                Duration = 3
            })
        else
            WindUI:Notify({
                Title = "自动收集已关闭",
                Content = "停止自动收集资源",
                Duration = 3
            })
        end
    end
})

-- 后台循环
spawn(function()
    while true do
        print("子脚本运行中 - 作者: 子杨")
        wait(5)  -- 改为5秒一次，避免过于频繁
    end
end)

-- 脚本加载完成通知
WindUI:Notify({
    Title = "脚本加载完成",
    Content = "子脚本 v1.0 已就绪\n作者: 子杨 QQ: 3775449458",
    Duration = 5
})
